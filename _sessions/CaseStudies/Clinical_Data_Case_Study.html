<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Case study: Clinical</title>

<script src="Clinical_Data_Case_Study_files/header-attrs/header-attrs.js"></script>
<script src="Clinical_Data_Case_Study_files/jquery/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Clinical_Data_Case_Study_files/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="Clinical_Data_Case_Study_files/bootstrap/js/bootstrap.min.js"></script>
<script src="Clinical_Data_Case_Study_files/bootstrap/shim/html5shiv.min.js"></script>
<script src="Clinical_Data_Case_Study_files/bootstrap/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="Clinical_Data_Case_Study_files/navigation/tabsets.js"></script>
<link href="Clinical_Data_Case_Study_files/highlightjs/default.css" rel="stylesheet" />
<script src="Clinical_Data_Case_Study_files/highlightjs/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="practical.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Case study: Clinical</h1>
<h4 class="author"><table style='table-layout:fixed;width:100%;border:0;padding:0;margin:0'>
<col width='10%'>
<col width='10%'>
<tr style="border:none">
<td style="display:block;width:100%;text-align:left;vertical-align:bottom;padding:0;margin:0;border:none" nowrap>
<font style='font-style:normal'>Introduction to Data Science with
R</font><br> <a href='https://dwulff.github.io/Intro2R_Unibe_2022/'>
<i class='fas fa-clock' style='font-size:.9em;' ></i> </a>
<a href='https://therbootcamp.github.io'>
<i class='fas fa-home' style='font-size:.9em;'></i> </a>
<a href='mailto:therbootcamp@gmail.com'>
<i class='fas fa-envelope' style='font-size: .9em;'></i> </a>
<a href='https://www.linkedin.com/company/basel-r-bootcamp/'>
<i class='fab fa-linkedin' style='font-size: .9em;'></i> </a>
<a href='https://therbootcamp.github.io'>
<font style='font-style:normal'>The R Bootcamp</font> </a>
</td>
<td style="width:100%;vertical-align:bottom;text-align:right;padding:0;margin:0;border:none">
<img src='https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png' style='height:15px;width:80px'/>
</td>
</tr>
</table></h4>

</div>


<p align="center">
<img width="100%" src="image/clinical.jpg" margin=0><br>
<font style="font-size:10px">adapted from <a
href="http://www.formerfda.com/wp-content/uploads/2014/08/clinical-trials.jpg">formerfda.com</a></font>
</p>
<div id="section" class="section level1 tabset">
<h1 class="tabset"></h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>In this case study, we will look at the results of a clinical trial
exploring the effectiveness of a new medication called dimarta on
reducing histamine in patients with a disease that leads to chronically
high histamine levels. In the study, 300 patients were assigned to one
of three different treatment arms. One arm was given a placebo. The
other arm was given adiclax – the standard of care for the disease.
Finally, the third arm was given dimarta. There were two main measures
of interest in the trial: patient’s changes in histamine from the
beginning to the end of the trial, and their change in quality of life
(measured by self report).</p>
<p>In addition to exploring the effects of the three medications, the
researchers are interested in the extent to which three different
biomarkers, dw, ms, and np, are correlated with therapeutic outcomes. In
other words, to patients that express one or more of these biomarkers
have better, or worse, outcomes that those that do not express these
biomarkers?</p>
</div>
<div id="tasks" class="section level2">
<h2>Tasks</h2>
<div id="a---getting-setup" class="section level3">
<h3>A - Getting Setup</h3>
<ol style="list-style-type: decimal">
<li><p>Open your <code>TheRBootcamp</code> R project. It should already
have the folders <code>1_Data</code> and <code>2_Code</code>.</p></li>
<li><p>Create and work in an R Markdown document for this case study.
Save your markdown file <code>2_Code</code> under the name
<code>clinical_casestudy.Rmd</code>.</p></li>
<li><p>At the top of the script, load the <code>tidyverse</code>
package.</p></li>
</ol>
</div>
<div id="b---data-io" class="section level3">
<h3>B - Data I/O</h3>
<ol style="list-style-type: decimal">
<li>Using <code>read_csv()</code>, load the
<code>dimarta_trial.csv</code>, <code>dimarta_demographics.csv</code>,
and <code>dimarta_biomarker.csv</code> datasets as <em>three</em> new
objects called <code>trial_df</code>, <code>demographics_df</code>, and
<code>biomarker_df</code>.</li>
</ol>
<pre class="r"><code>## read in datasets
trial_df &lt;- read_csv(&quot;1_Data/dimarta_trial.csv&quot;)
demographics_df &lt;- read_csv(&quot;1_Data/dimarta_demographics.csv&quot;)
biomarker_df &lt;- read_csv(&quot;1_Data/dimarta_biomarker.csv&quot;)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Get a first impression of the objects you just created by exploring
them with a mixture of the <code>View()</code>, <code>head()</code>,
<code>names()</code>, and <code>str()</code> functions. Were they all
loaded correctly?</li>
</ol>
<pre class="r"><code>trial_df</code></pre>
<pre><code># A tibble: 300 × 6
  PatientID   arm histamine…¹ hista…² qol_s…³
  &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 txdjezeo      1        58.6    67.0       3
2 htxfjlxk      3        36.1    28.0       3
3 vkdqhyez      1        57.7    57.3       2
4 dbuvrwfq      3        56.6    57.4       2
5 ydaitaah      2        64.7    67.9       5
# … with 295 more rows, and abbreviated
#   variable names ¹​histamine_start,
#   ²​histamine_end, ³​qol_start
# ℹ Use `print(n = ...)` to see more rows</code></pre>
<pre class="r"><code>demographics_df</code></pre>
<pre><code># A tibble: 300 × 5
  PatientID   age gender site  diseasestatus
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;        
1 pkyivajv     36      0 Tokyo Mid          
2 dbuvrwfq     39      0 Paris Late         
3 jhuztppp     30      0 Tokyo Mid          
4 qejexgza     34      1 Tokyo Late         
5 cszrjxju     41      1 Tokyo Late         
# … with 295 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
<pre class="r"><code>biomarker_df</code></pre>
<pre><code># A tibble: 900 × 3
  PatientID Biomarker BiomarkerStatus
  &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;          
1 ygazqssv  dw        FALSE          
2 qosueuyw  ms        FALSE          
3 bhhykjvw  ms        FALSE          
4 ifajorty  np        TRUE           
5 gxnsybdt  ms        FALSE          
# … with 895 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<div id="c---data-wrangling" class="section level3">
<h3>C - Data Wrangling</h3>
<ol style="list-style-type: decimal">
<li>Change the name of the column <code>arm</code> in the
<code>trial_df</code> data to <code>StudyArm</code>.</li>
</ol>
<pre class="r"><code>trial_df &lt;- trial_df %&gt;%
  rename(StudyArm = arm)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Using the <code>table()</code> function, look at the values of the
<code>StudyArm</code> column in <code>trial_df</code>. You’ll notice the
values are 1, 2, and 3. Using <code>mutate()</code> and
<code>case_when()</code> change these values to the appropriate names of
the study arms (look at the variable descriptions to see which is
which!)</li>
</ol>
<pre class="r"><code># table(trial_df$StudyArm)

trial_df &lt;- trial_df %&gt;%
  mutate(StudyArm = case_when(
    StudyArm == 1 ~ &quot;placebo&quot;,
    StudyArm == 2 ~ &quot;adiclax&quot;,
    StudyArm == 3 ~ &quot;dimarta&quot;
  ))</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>In the <code>demographics_df</code> data, you’ll see that gender is
coded as 0 and 1. Using <code>mutate()</code> create a <em>new</em>
column in <code>demographics_df</code> called <code>gender_c</code> that
shows gender as a string, where 0 = “male”, and 1 = “female”.</li>
</ol>
<pre class="r"><code>demographics_df &lt;- demographics_df %&gt;%
  mutate(gender_c = case_when(
    gender == 0 ~ &quot;male&quot;,
    gender == 1 ~ &quot;female&quot;
  ))</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Now let’s create a new object called <code>dimarta_df</code> that
combines data from <code>trial_df</code> and
<code>demographics_df</code>. To do this, use <code>left_join()</code>
to combine the <code>trial_df</code> data with the
<code>demographics_df</code> data. This will merge the two datasets so
you can have the study results and demographic data in the same
dataframe. Make sure to assign the result to a new object called
<code>dimarta_df</code></li>
</ol>
<pre class="r"><code># Create a new dataframe called dimarta_df that contains both trial_df and demographics_df
dimarta_df &lt;- trial_df %&gt;%
  left_join(demographics_df)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>You’ll notice that the biomarker_df dataframe is in the ‘long’
format, where each row is a patient’s biomarker result. Making use of
the <code>pivot_wider()</code> function, create a new dataframe called
biomarker_wide_df where each row is a patient, and the results from
different biomarkers are in different columns. When you finish, look at
biomarker_wide_df to see how it looks!</li>
</ol>
<pre class="r"><code>biomarker_wide_df &lt;- 
biomarker_df %&gt;%
  pivot_wider(names_from = &#39;XX&#39;,
              values_from = &#39;XX&#39;)</code></pre>
<pre class="r"><code>biomarker_wide_df &lt;- 
biomarker_df %&gt;%
  pivot_wider(names_from = &#39;Biomarker&#39;,
              values_from = &#39;BiomarkerStatus&#39;)</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Now, using the <code>left_join</code> function, add the
<code>biomarker_wide_df</code> data to the <code>dimarta_df</code> data!
Now you should have all of the data in a single dataframe called
<code>dimarta_df</code></li>
</ol>
<pre class="r"><code>dimarta_df &lt;- dimarta_df %&gt;% 
  left_join(biomarker_wide_df)</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>View <code>dimarta_df</code> to make sure the data look correct! The
data should have one row for each patient, and 13 separate columns,
including <code>dw</code>, <code>ms</code>, and <code>np</code></li>
</ol>
<pre class="r"><code>dimarta_df</code></pre>
<pre><code># A tibble: 300 × 14
  PatientID StudyArm histam…¹ hista…² qol_s…³
  &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 txdjezeo  placebo      58.6    67.0       3
2 htxfjlxk  dimarta      36.1    28.0       3
3 vkdqhyez  placebo      57.7    57.3       2
4 dbuvrwfq  dimarta      56.6    57.4       2
5 ydaitaah  adiclax      64.7    67.9       5
# … with 295 more rows, and abbreviated
#   variable names ¹​histamine_start,
#   ²​histamine_end, ³​qol_start
# ℹ Use `print(n = ...)` to see more rows</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Using the <code>mean()</code> function, calculate the mean age of
all patients.</li>
</ol>
<pre class="r"><code>mean(dimarta_df$age)</code></pre>
<pre><code>[1] 39.9</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Create a table showing how many male and female patients were in the
trial.</li>
</ol>
<pre class="r"><code>dimarta_df %&gt;%
  group_by(XXX) %&gt;%
  summarise(
    Counts = n()    
  )</code></pre>
<pre class="r"><code>dimarta_df %&gt;%
  group_by(gender_c) %&gt;%
  summarise(
    Counts = n()    
  )</code></pre>
<pre><code># A tibble: 2 × 2
  gender_c Counts
  &lt;chr&gt;     &lt;int&gt;
1 female      140
2 male        160</code></pre>
<ol start="10" style="list-style-type: decimal">
<li>Now, using similar code, find out how many patients were assigned to
each study arm.</li>
</ol>
<pre class="r"><code>dimarta_df %&gt;%
  group_by(StudyArm) %&gt;%
  summarise(
    Counts = n()    
  )</code></pre>
<pre><code># A tibble: 3 × 2
  StudyArm Counts
  &lt;chr&gt;     &lt;int&gt;
1 adiclax     100
2 dimarta     100
3 placebo     100</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Find out how many men and women were assigned to each study arm
(Hint: You can use very similar code to what you used above, just add a
second grouping variable!)</li>
</ol>
<pre class="r"><code>dimarta_df %&gt;%
  group_by(StudyArm, gender_c) %&gt;%
    summarise(Counts = n())</code></pre>
<pre><code># A tibble: 6 × 3
# Groups:   StudyArm [3]
  StudyArm gender_c Counts
  &lt;chr&gt;    &lt;chr&gt;     &lt;int&gt;
1 adiclax  female       41
2 adiclax  male         59
3 dimarta  female       49
4 dimarta  male         51
5 placebo  female       50
# … with 1 more row
# ℹ Use `print(n = ...)` to see more rows</code></pre>
<ol start="12" style="list-style-type: decimal">
<li>Add a new column to the <code>dimarta_df</code> data called
<code>histamine_change</code> that shows the <em>change</em> in
patient’s histamine levels from the start to the end of the trial (Hint:
use <code>mutate()</code> and just subtract <code>histamine_start</code>
from <code>histamine_end</code>!)</li>
</ol>
<pre class="r"><code>dimarta_df &lt;- dimarta_df %&gt;%
  mutate(
    histamine_change = histamine_end - histamine_start
  )</code></pre>
<ol start="13" style="list-style-type: decimal">
<li>Add a new column to <code>dimarta_df</code> called
<code>qol_change</code> that shows the change in patient’s quality of
life.</li>
</ol>
<pre class="r"><code>dimarta_df &lt;- dimarta_df %&gt;%
  mutate(
    qol_change = qol_end - qol_start
  )

# Look at result
dimarta_df %&gt;% 
  select(qol_change)</code></pre>
<pre><code># A tibble: 300 × 1
  qol_change
       &lt;dbl&gt;
1          0
2          1
3          0
4          1
5          2
# … with 295 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
<ol start="14" style="list-style-type: decimal">
<li>Calculate the percentage of patients who tested positive for each of
the three biomarkers (Hint: If you calculate the <code>mean()</code> of
a logical vector, you will get the percentage of TRUE values!)</li>
</ol>
<pre class="r"><code># Calculate percent of patients with positive biomarkers

dimarta_df %&gt;%
  summarise(
    dw_mean = mean(XXX),
    ms_percent = mean(XXX),
    np_percent = mean(XXX)
  )</code></pre>
<pre class="r"><code># Calculate percent of patients with positive biomarkers

dimarta_df %&gt;%
  summarise(
    dw_mean = mean(dw),
    ms_percent = mean(ms),
    np_percent = mean(np)
  )</code></pre>
<pre><code># A tibble: 1 × 3
  dw_mean ms_percent np_percent
    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1   0.257       0.19      0.233</code></pre>
<ol start="15" style="list-style-type: decimal">
<li>Were there different distributions of age in the different trial
sites? To answer this, separately calculate the mean and standard
deviations of patient ages in each site. (Hint: group the data by
<code>site</code>, then calculate two separate summary statistics:
<code>age_mean = mean(age)</code>, and
<code>age_sd = sd(age)</code>.</li>
</ol>
<pre class="r"><code># Calculate the mean change in histamine for each study site
dimarta_df %&gt;%
  group_by(site) %&gt;%
  summarise(
    age_mean = mean(age),
    age_sd = sd(age)
  )</code></pre>
<pre><code># A tibble: 3 × 3
  site   age_mean age_sd
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 London     39.9   5.86
2 Paris      39.8   4.84
3 Tokyo      40.1   4.50</code></pre>
<ol start="16" style="list-style-type: decimal">
<li>Calculate the mean change in histamine results separately for each
study site</li>
</ol>
<pre class="r"><code># Calculate the mean change in histamine for each study site
dimarta_df %&gt;%
  group_by(site) %&gt;%
  summarise(
    histamine_change_mean = mean(histamine_change, na.rm = TRUE)
  )</code></pre>
<pre><code># A tibble: 3 × 2
  site   histamine_change_mean
  &lt;chr&gt;                  &lt;dbl&gt;
1 London                  1.99
2 Paris                   2.29
3 Tokyo                   1.29</code></pre>
<ol start="17" style="list-style-type: decimal">
<li>Calculate the mean change in histamine results
(<code>histamine_change</code>) for each study arm. Which study arm had
a largest decrease in histamine?</li>
</ol>
<pre class="r"><code># Calculate the mean change in histamine for each study site
dimarta_df %&gt;%
  group_by(StudyArm) %&gt;%
  summarise(
    histamine_change_mean = mean(histamine_change, na.rm = TRUE)
  )</code></pre>
<pre><code># A tibble: 3 × 2
  StudyArm histamine_change_mean
  &lt;chr&gt;                    &lt;dbl&gt;
1 adiclax                  0.210
2 dimarta                  2.51 
3 placebo                  2.90 </code></pre>
<ol start="18" style="list-style-type: decimal">
<li>Calculate the mean change in quality of life
(<code>qol_change</code>) for each study arm. Do the results match what
you found with the histamine results?</li>
</ol>
<pre class="r"><code># Calculate the mean change in histamine for each study site
dimarta_df %&gt;%
  group_by(StudyArm) %&gt;%
  summarise(
    qol_change_mean = mean(qol_change, na.rm = TRUE)
  )</code></pre>
<pre><code># A tibble: 3 × 2
  StudyArm qol_change_mean
  &lt;chr&gt;              &lt;dbl&gt;
1 adiclax             0.06
2 dimarta             0.01
3 placebo            -0.15</code></pre>
</div>
<div id="d---plotting" class="section level3">
<h3>D - Plotting</h3>
<ol style="list-style-type: decimal">
<li>Create boxplots showing the relationship between study arm and
histamine change. (Tip! convert <code>StudyArm</code> to a factor with
factor(StudyArm))</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       mapping = aes(x = StudyArm, 
                     y = histamine_change)) +
  geom_boxplot() +
  labs(title = &quot;Histamine change&quot;,
       subtitle = &quot;Dimarta&quot;,
       caption = &quot;I love R!&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-31-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Try using <code>geom_jitter()</code> to add the raw points to the
plot</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       mapping = aes(x = StudyArm, 
                     y = histamine_change)) +
  geom_boxplot() + 
  geom_jitter(width = .1) +
  labs(title = &quot;Histamine change&quot;,
       subtitle = &quot;Dimarta&quot;,
       caption = &quot;I love R!&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-32-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Create the same plot as above, but instead of analysing study arm,
try analysing gender. (Tip! convert gender to a factor with
<code>factor(gender)</code>) What do you find? Did one gender have
better histamine improvements than the other?</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       mapping = aes(x = factor(gender), 
                     y = histamine_change)) +
  geom_boxplot() +
  geom_jitter(width = .1) +
  labs(title = &quot;Histamine change&quot;,
       subtitle = &quot;Dimarta&quot;,
       caption = &quot;I love R!&quot;,
       x = &quot;Gender&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-33-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Now create the same plot but show both gender and study arm in the
same plot. One way to do this would be to color the points by
gender!</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       mapping = aes(x = StudyArm, 
                     y = histamine_change,
                     col = factor(gender))) +
  geom_boxplot() +
  geom_jitter(width = .1) +
  labs(title = &quot;Histamine change&quot;,
       subtitle = &quot;Dimarta&quot;,
       caption = &quot;I love R!&quot;,
       x = &quot;Gender&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-34-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Is there a correlation between patient’s starting and ending
histamine levels? Create a scatterplot with a regression line to find
out!</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       aes(x = histamine_start, 
           y = histamine_end)) +
  geom_point() + 
  geom_smooth() +
  labs(title = &quot;Histamine start and end correlation&quot;,
       caption = &quot;Dimarta&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-36-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>Now create the same plot as above, but have different colored points
for different study arms (but only one regression line).</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       aes(x = histamine_start, 
           y = histamine_end,
           col = StudyArm)) +
  geom_point() + 
  geom_smooth(col = &quot;black&quot;) +
  labs(title = &quot;Histamine start and end correlation&quot;,
       caption = &quot;Dimarta&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-37-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Instead of having different study arms as different colored points,
create another plot using <code>facet_wrap()</code> to have different
study arms in different plotting panels.</li>
</ol>
<pre class="r"><code>ggplot(data = dimarta_df,
       aes(x = histamine_start, 
           y = histamine_end)) +
  geom_point() + 
  geom_smooth(col = &quot;black&quot;) +
  facet_wrap(~ StudyArm) +
  labs(title = &quot;Histamine start and end correlation&quot;,
       caption = &quot;Dimarta&quot;)</code></pre>
<p><img src="Clinical_Data_Case_Study_files/figure-html/unnamed-chunk-38-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<table>
<colgroup>
<col width="8%" />
<col width="10%" />
<col width="11%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">File</th>
<th align="left">Rows</th>
<th align="left">Columns</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a
href="https://raw.githubusercontent.com/therbootcamp/BaselRBootcamp_2018July/master/_sessions/_data/baselrbootcamp_data/dimarta_trial.csv">dimarta_trial.csv</a></td>
<td align="left">300</td>
<td align="left">6</td>
<td align="left">Key DIMARTA trial outcomes</td>
</tr>
<tr class="even">
<td align="left"><a
href="https://raw.githubusercontent.com/therbootcamp/BaselRBootcamp_2018July/master/_sessions/_data/baselrbootcamp_data/dimarta_biomarker.csv">dimarta_biomarker.csv</a></td>
<td align="left">900</td>
<td align="left">3</td>
<td align="left">Biomarker status’ for 3 different biomarkers for each
patient.</td>
</tr>
<tr class="odd">
<td align="left"><a
href="https://raw.githubusercontent.com/therbootcamp/BaselRBootcamp_2018July/master/_sessions/_data/baselrbootcamp_data/dimarta_demographics.csv">dimarta_demographics.csv</a></td>
<td align="left">300</td>
<td align="left">5</td>
<td align="left">Demographic information for each patient</td>
</tr>
</tbody>
</table>
<p>Column Descriptions</p>
<p><strong>dimarta_trial.csv</strong></p>
<table>
<caption>Table 1. <code>dimarta_trial.csv</code> variable
description:</caption>
<colgroup>
<col width="32%" />
<col width="67%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PatientID</td>
<td align="left">Unique patient id</td>
</tr>
<tr class="even">
<td align="left">arm</td>
<td align="left">Treatment arm, either 1 = placebo, 2 = adiclax (the
standard of treatment), or 3 = dimarta (the target drug)</td>
</tr>
<tr class="odd">
<td align="left">histamine_start</td>
<td align="left">histamine value at the start of the trial</td>
</tr>
<tr class="even">
<td align="left">histamine_end</td>
<td align="left">histamine value at the end of the trial</td>
</tr>
<tr class="odd">
<td align="left">qol_start</td>
<td align="left">Patient’s rated quality of life at the start of the
trial</td>
</tr>
<tr class="even">
<td align="left">qol_end</td>
<td align="left">Patient’s rated quality of life at the end of the
trial</td>
</tr>
</tbody>
</table>
<p><strong>dimarta_demographics.csv</strong></p>
<table>
<caption>Table 2. <code>dimarta_demographics.csv</code> variable
description:</caption>
<colgroup>
<col width="32%" />
<col width="67%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PatientID</td>
<td align="left">Unique patient id</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="left">Patient age</td>
</tr>
<tr class="odd">
<td align="left">gender</td>
<td align="left">Patient gender, 0 = male, 1 = female</td>
</tr>
<tr class="even">
<td align="left">site</td>
<td align="left">Site where the clinical trial was conducted</td>
</tr>
<tr class="odd">
<td align="left">disease status</td>
<td align="left">Status of the patient’s disease at start of trial</td>
</tr>
</tbody>
</table>
<p><strong>dimarta_biomarker.csv</strong></p>
<table>
<caption>Table 3. <code>dimarta_biomarker.csv</code> variable
description:</caption>
<colgroup>
<col width="32%" />
<col width="67%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PatientID</td>
<td align="left">Unique patient id</td>
</tr>
<tr class="even">
<td align="left">Biomarker</td>
<td align="left">One of three biomarkers: dw, ms, and np</td>
</tr>
<tr class="odd">
<td align="left">BiomarkerStatus</td>
<td align="left">Result of the test for the biomarker.</td>
</tr>
</tbody>
</table>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<div id="packages" class="section level3">
<h3>Packages</h3>
<table>
<thead>
<tr class="header">
<th align="left">Package</th>
<th align="left">Installation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyverse</code></td>
<td align="left"><code>install.packages("tidyverse")</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
